---
const { totalPages, page, currentPage, rootURL } = Astro.props;

function getPageNumbers(total) {
    if (total <= 10) {
        return Array.from({ length: total }, (_, i) => i + 1);
    }
    return [1, 2, 3, "...", total - 2, total - 1, total];
}
---

{
    page && (
        <nav class="flex justify-center gap-2 mt-12" aria-label="Pagination">
            {page.url.prev ? (
                <a
                    href={page.url.prev}
                    class="px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded"
                >
                    ← Previous
                </a>
            ) : null}

            {Array.from({ length: page.lastPage }, (_, i) => i + 1).map(
                (pageNumber) =>
                    pageNumber === page.currentPage ? (
                        <span class="px-4 py-2 bg-blue-600 text-white rounded">
                            {pageNumber}
                        </span>
                    ) : (
                        <a
                            href={
                                pageNumber === 1
                                    ? rootURL
                                    : `/page/${pageNumber}`
                            }
                            class="px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded"
                        >
                            {pageNumber}
                        </a>
                    ),
            )}

            {page.url.next ? (
                <a
                    href={page.url.next}
                    class="px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded"
                >
                    Next →
                </a>
            ) : null}
        </nav>
    )
}

{
    totalPages > 1 && (
        <nav class="flex justify-center gap-2 mt-12" aria-label="Pagination">
            {getPageNumbers(totalPages).map((pageNumber) =>
                pageNumber === "..." ? (
                    <span class="px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded">
                        {pageNumber}
                    </span>
                ) : pageNumber === currentPage ? (
                    <span class="px-4 py-2 bg-blue-600 text-white rounded">
                        {pageNumber}
                    </span>
                ) : (
                    <a
                        href={
                            pageNumber === 1
                                ? rootURL
                                : `${rootURL}page/${pageNumber}`
                        }
                        class="px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded"
                    >
                        {pageNumber}
                    </a>
                ),
            )}
        </nav>
    )
}
