---
import { getCollection } from "astro:content";
import BaseLayout from "../../layouts/BaseLayout.astro";
import PostContainer from "../../components/PostContainer.astro";
import Pagination from "../../components/Pagination.astro";

export async function getStaticPaths({ paginate }) {
    const isDev = import.meta.env.DEV;
    const allPosts = (await getCollection("posts"))
        .filter((post) => isDev || !post.data.draft)
        .filter((post) => !post.data.hide)
        .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());

    return paginate(allPosts, { pageSize: 10 });
}

const { page } = Astro.props;
---

<BaseLayout title={`Page ${page.currentPage}`}>
    <h1>Page {page.currentPage}</h1>

    <PostContainer posts={page.data} />

    <Pagination page={page} rootURL={"/"} />
</BaseLayout>
